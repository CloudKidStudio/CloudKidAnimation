!function(){var t=function(){},n=t.prototype;n.onComplete=null,n.onCompleteParams=null,n.event=null,n.instance=null,n.firstFrame=-1,n.lastFrame=-1,n.isLooping=!1,n.isLastFrame=!1,n.length=0,n._paused=!1,Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){t!=this._paused&&(this._paused=!!t,this.soundInst&&(this.paused?this.soundInst.pause():this.soundInst.unpause()))}}),n.startTime=0,n.duration=0,n.speed=1,n.time=0,n.soundAlias=null,n.soundInst=null,n.playSound=!1,n.soundStart=0,n.soundEnd=0,namespace("cloudkid").AnimatorTimeline=t}(),function(t){var n=cloudkid.OS,i=cloudkid.AnimatorTimeline,e=createjs.MovieClip,a=function(){};a.VERSION="2.0.3",a.debug=!1,a.soundLib=null;var s=[],o=[],l={},r=!1;a.init=function(){s=[],o=[],l={},r=!1},a.destroy=function(){a.stopAll(),s=null,o=null,l=null},a.play=function(n,i,e,o,r,u,c,p){e=e||null,o=o||null,r=r?.001*r:0,u=u||1,p=p||!1,s||a.init(),l[n.id]!==t&&a.stop(n,p);var d=a._makeTimeline(n,i,e,o,u,c);return d.firstFrame>-1&&d.lastFrame>-1?(d.time=r,n._elapsedTime=d.startTime+d.time,n.play(),n._tick(),a._hasTimelines()||a._startUpdate(),s.push(d),l[n.id]=d,d):(e&&e.apply(null,o),null)},a.playAtRandomFrame=function(n,i,e,o,r){e=e||null,o=o||null,r=r||1,doCancelledCallback=doCancelledCallback||!1,s||a.init(),l[n.id]!==t&&a.stop(n,!1);var u=a._makeTimeline(n,i,e,o,dropFrames);return u.firstFrame>-1&&u.lastFrame>-1?(u.time=Math.random()*u.duration,n._elapsedTime=u.startTime+u.time,n.play(),n._tick(),a._hasTimelines()||a._startUpdate(),s.push(u),l[n.id]=u,u):(a.debug&&Debug.log("No event "+i+" was found, or it lacks an end, on this MovieClip "+n),e&&e.apply(null,o),null)},a._makeTimeline=function(n,a,s,o,l,r){var u=new i;if(n instanceof e==!1)return u;if(n.advanceDuringTicks=!1,!n.getAnimFrameRate()){var c=cloudkid.OS.instance.options.fps;c||(c=cloudkid.OS.instance.fps),c||(c=15),n.enableFramerateIndependence(15)}u.instance=n,u.event=a,u.onComplete=s,u.onCompleteParams=o,u.speed=l,r&&(u.playSound=!0,u.soundStart=r.start,u.soundAlias=r.alias);var p=n.timeline.resolve(a),d=n.timeline.resolve(a+"_stop"),m=n.timeline.resolve(a+"_loop");return p!==t&&(u.firstFrame=p,u.startTime=p/n.getAnimFrameRate()),d!==t?u.lastFrame=d:m!==t&&(u.lastFrame=m,u.isLooping=!0),u.length=u.lastFrame-u.firstFrame,u.duration=u.length/n.getAnimFrameRate(),u},a.instanceHasAnimation=function(n,i){var e=n.timeline.resolve(i),a=n.timeline.resolve(i+"_stop"),s=n.timeline.resolve(i+"_loop");return e!==t&&(a!==t||s!==t)},a.stop=function(n,i){if(i=i||!1,s&&l[n.id]!==t){var e=l[n.id];a._remove(e,i)}},a.stopAll=function(t){if(a._hasTimelines())for(var n,i=s.slice(),e=0;e<i.length;e++)n=i[e],(!t||t.contains(n.instance))&&a._remove(n,!1)},a._remove=function(t,n){var i=o.indexOf(t);if(i>=0&&o.splice(i,1),i=s.indexOf(t),!(0>i)){var e=t.onComplete,r=t.onCompleteParams;t.instance.stop(),t.soundInst&&t.soundInst.stop(),s.splice(i,1),delete l[t.instance.id],t.instance=null,t.event=null,t.onComplete=null,t.onCompleteParams=null,a._hasTimelines()||a._stopUpdate(),n&&e&&e.apply(null,r)}},a.pause=function(){if(s&&!r){r=!0;for(var t=0;t<s.length;t++)s[t].paused=!0;a._stopUpdate()}},a.resume=function(){if(s&&r){r=!1;for(var t=0;t<s.length;t++)s[t].paused=!1;a._hasTimelines()&&a._startUpdate()}},a.pauseInGroup=function(t,n){if(a._hasTimelines()&&n)for(var i=0;i<s.length;i++)n.contains(s[i].instance)&&(s[i].paused=t)},a.getTimeline=function(n){return a._hasTimelines()?l[n.id]!==t?l[n.id]:null:null},a.getPaused=function(){return r},a._startUpdate=function(){n.instance&&n.instance.addUpdateCallback("Animator",a._update)},a._stopUpdate=function(){n.instance&&n.instance.removeUpdateCallback("Animator")},a._update=function(t){if(s){for(var n,i=.001*t,e=s.length-1;e>=0;--e){n=s[e];var l=n.instance;if(!n.paused){{n.time}if(n.soundInst){if(!n.soundInst.isValid){o.push(n);continue}n.time=n.soundStart+.001*n.soundInst.position}else n.time+=i*n.speed,n.time>=n.duration&&(n.isLooping?(n.time-=n.duration,n.onComplete&&n.onComplete.apply(null,n.onCompleteParams)):(l.gotoAndStop(n.lastFrame),o.push(n))),n.playSound&&n.time>=n.soundStart&&(n.time=n.soundStart,n.soundInst=a.audioLib.play(n.soundAlias,c.bind(this,n),u.bind(this,n)));l._elapsedTime=n.startTime+n.time,l._tick()}}for(e=0;e<o.length;e++)n=o[e],a._remove(n,!0)}};var u=function(t){t.playSound=!1,t.soundEnd=t.soundStart+.001*t.soundInst.length},c=function(t){t.soundEnd>0&&t.soundEnd>t.time&&(t.time=t.soundEnd),t.soundInst=null};a._hasTimelines=function(){return s?s.length>0:!1},a.toString=function(){return"[Animator version:"+a.VERSION+"]"},namespace("cloudkid").Animator=a}(),function(){var t=function(t,n){this.initialize(t,n)},n=t.prototype;n.event=null,n.loops=0,n.initialize=function(t,n){this.event=t,this.loops=n||0},namespace("cloudkid").CharacterClip=t}(),function(){var t=cloudkid.Animator,n=function(){this.initialize()},i=n.prototype;p_animationStack=null,i._currentAnimation=null,i._loops=0,i._interruptable=!0,i._allowFrameDropping=!1,i._character=null,i._callback=null,i._destroyed=!1,i.initialize=function(){this._animationStack=[]},i.setCharacter=function(t){this.clear(),this._character=t,this._character&&(Debug.assert(this._character instanceof createjs.MovieClip,"character must subclass MovieClip"),this._character.stop())},i.gotoFrameAndStop=function(n){Debug.assert(this._character,"gotoFrameAndStop() requires a character!"),t.stop(this._character),this._animationStack.length=0,this._character.gotoAndStop(n)},i.playClips=function(n,i,e,a,s){if(i=i||null,e=e||!0,a=a||!0,s=s||!0,Debug.assert(this._character,"playClips requires a character!"),this._interruptable){t.stop(this._character),this._interruptable=e,this._callback&&!a&&this._callback(!0),this._callback=i,this._animationStack.length=0;for(var o in n)this._animationStack.push(n[o]);this._allowFrameDropping=s,this.startNext()}},i.startNext=function(){if(this._loops=0,this._animationStack.length>0)this._currentAnimation=this._animationStack.shift(),t.play(this._character,this._currentAnimation.event,this._animationComplete.bind(this),[this],this._allowFrameDropping);else if(this._callback){this._interruptable=!0;var n=this._callback;this._callback=null,n(!1)}},i._animationComplete=function(){this._loops++,0===this._currentAnimation.loops||this._loops<this._currentAnimation.loops?t.play(this._character,this._currentAnimation.event,this._animationComplete.bind(this),[],this._allowFrameDropping):this._currentAnimation.loops==this._loops&&this.startNext()},i.clear=function(){this._character&&t.stop(this._character),this._currentAnimation=null,this._interruptable=!0,this._callback=null,this._animationStack.length=0,this._loops=0},i.destroy=function(){this._destroyed||(this._destroyed=!0,this.clear(),this._character=null,this._animationStack=null)},namespace("cloudkid").CharacterController=n}();