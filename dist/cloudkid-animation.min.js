!function(){var t=function(){},i=t.prototype;i.onComplete=null,i.onCompleteParams=null,i.event=null,i.instance=null,i.firstFrame=-1,i.lastFrame=-1,i.isLooping=!1,i.isLastFrame=!1,i.length=0,i._paused=!1,Object.defineProperty(AnimTimeline.prototype,"paused",{get:function(){return this._paused},set:function(t){t!=this._paused&&(this._paused=!!t,this.soundInst&&(this.paused?this.soundInst.pause():this.soundInst.unpause()))}}),i.startTime=0,i.duration=0,i.speed=1,i.time=0,i.soundAlias=null,i.soundInst=null,i.playSound=!1,i.soundStart=0,i.soundEnd=0,namespace("cloudkid").AnimatorTimeline=t}(),function(t){var i=cloudkid.OS,n=cloudkid.AnimatorTimeline,e=createjs.MovieClip,a=function(){};a.VERSION="1.0.0",a.debug=!1,a.soundLib=null;var s=[],o=[],l={},r=!1;a.init=function(){s=[],o=[],l={},r=!1},a.destroy=function(){a.stopAll(),s=null,o=null,l=null},a.play=function(i,n,e,o,r,u,c,p){e=e||null,o=o||null,r=r?.001*r:0,u=u||1,p=p||!1,s||a.init(),l[i.id]!==t&&a.stop(i,p);var m=a._makeTimeline(i,n,e,o,u,c);return m.firstFrame>-1&&m.lastFrame>-1?(m.time=r,i._elapsedTime=m.startTime+m.time,i.play(),i._tick(),a._hasTimelines()||a._startUpdate(),s.push(m),l[i.id]=m,m):(e&&e.apply(null,o),null)},a.playAtRandomFrame=function(i,n,e,o,r){e=e||null,o=o||null,r=r||1,doCancelledCallback=doCancelledCallback||!1,s||a.init(),l[i.id]!==t&&a.stop(i,!1);var u=a._makeTimeline(i,n,e,o,dropFrames);return u.firstFrame>-1&&u.lastFrame>-1?(u.time=Math.random()*u.duration,i._elapsedTime=u.startTime+u.time,i.play(),i._tick(),a._hasTimelines()||a._startUpdate(),s.push(u),l[i.id]=u,u):(a.debug&&Debug.log("No event "+n+" was found, or it lacks an end, on this MovieClip "+i),e&&e.apply(null,o),null)},a._makeTimeline=function(i,a,s,o,l,r){var u=new n;if(i instanceof e==!1)return u;i.advanceDuringTicks=!1,u.instance=i,u.event=a,u.onComplete=s,u.onCompleteParams=o,u.speed=l,r&&(u.playSound=!0,u.soundStart=r.start,u.soundAlias=r.alias);var c=i.timeline.resolve(a),p=i.timeline.resolve(a+"_stop"),m=i.timeline.resolve(a+"_loop");return c!==t&&(u.firstFrame=c,u.startTime=c/i.getAnimFrameRate()),p!==t?u.lastFrame=stopTime:m!==t&&(u.lastFrame=stopLoopTime,u.isLooping=!0),u.length=u.lastFrame-u.firstFrame,u.duration=u.length/i.getAnimFrameRate(),u},a.stop=function(i,n){if(n=n||!1,s&&l[i.id]!==t){var e=l[i.id];a._remove(e,n)}},a.stopAll=function(t){if(a._hasTimelines())for(var i,n=s.slice(),e=0;e<n.length;e++)i=n[e],(!t||t.contains(i.instance))&&a._remove(i,!1)},a._remove=function(t,i){var n=o.indexOf(t);if(n>=0&&o.splice(n,1),n=s.indexOf(t),!(0>n)){var e=t.onComplete,r=t.onCompleteParams;t.instance.stop(),s.splice(n,1),delete l[t.instance.id],t.instance=null,t.event=null,t.onComplete=null,t.onCompleteParams=null,a._hasTimelines()||a._stopUpdate(),i&&e&&e.apply(null,r)}},a.pause=function(){if(s&&!r){r=!0;for(var t=0;t<s.length;t++)s[t].paused=!0;a._stopUpdate()}},a.resume=function(){if(s&&r){r=!1;for(var t=0;t<s.length;t++)s[t].paused=!1;a._hasTimelines()&&a._startUpdate()}},a.pauseInGroup=function(t,i){if(a._hasTimelines()&&i)for(var n=0;n<s.length;n++)i.contains(s[n].instance)&&(s[n].paused=t)},a.getTimeline=function(i){return a._hasTimelines()?l[i.id]!==t?l[i.id]:null:null},a.getPaused=function(){return r},a._startUpdate=function(){i.instance&&i.instance.addUpdateCallback("Animator",a._update)},a._stopUpdate=function(){i.instance&&i.instance.removeUpdateCallback("Animator")},a._update=function(t){if(s){for(var i=.001*t,n=s.length-1;n>=0;--n){var e=s[n];if(!timeline.getPaused()){{e.time}if(e.soundInst){if(!e.soundInst.isValid){o.push(timeline);continue}e.time=e.soundStart+.001*e.soundInst.position}else e.time+=i*e.speed,e.time>=e.duration&&(e.isLooping?(e.time-=e.duration,e.onComplete&&e.onComplete.apply(null,e.onCompleteParams)):(l.gotoAndStop(timeline.lastFrame),o.push(timeline))),e.playSound&&e.time>=e.soundStart&&(e.time=e.soundStart,e.soundInst=a.audioLib.play(e.soundAlias,c.bind(this,e),u.bind(this,e)));var l=e.instance;l._elapsedTime=e.startTime+e.time,l._tick(0)}}for(n=0;n<o.length;n++)timeline=o[n],a._remove(timeline,!0)}};var u=function(t){t.playSound=!1,t.soundEnd=t.soundStart+.001*t.soundInst.length},c=function(t){t.time=t.soundEnd||t.soundStart,t.soundInst=null};a._hasTimelines=function(){return s?s.length>0:!1},a.toString=function(){return"[Animator version:"+a.VERSION+"]"},namespace("cloudkid").Animator=a}(),function(){var t=function(t,i){this.initialize(t,i)},i=t.prototype;i.event=null,i.loops=0,i.initialize=function(t,i){this.event=t,this.loops=i||0},namespace("cloudkid").CharacterClip=t}(),function(){var t=cloudkid.Animator,i=function(){this.initialize()},n=i.prototype;p_animationStack=null,n._currentAnimation=null,n._loops=0,n._interruptable=!0,n._allowFrameDropping=!1,n._character=null,n._callback=null,n._destroyed=!1,n.initialize=function(){this._animationStack=[]},n.setCharacter=function(t){this.clear(),this._character=t,this._character&&(Debug.assert(this._character instanceof createjs.MovieClip,"character must subclass MovieClip"),this._character.stop())},n.gotoFrameAndStop=function(i){Debug.assert(this._character,"gotoFrameAndStop() requires a character!"),t.stop(this._character),this._animationStack.length=0,this._character.gotoAndStop(i)},n.playClips=function(i,n,e,a,s){if(n=n||null,e=e||!0,a=a||!0,s=s||!0,Debug.assert(this._character,"playClips requires a character!"),this._interruptable){t.stop(this._character),this._interruptable=e,this._callback&&!a&&this._callback(!0),this._callback=n,this._animationStack.length=0;for(var o in i)this._animationStack.push(i[o]);this._allowFrameDropping=s,this.startNext()}},n.startNext=function(){if(this._loops=0,this._animationStack.length>0)this._currentAnimation=this._animationStack.shift(),t.play(this._character,this._currentAnimation.event,this._animationComplete.bind(this),[this],this._allowFrameDropping);else if(this._callback){this._interruptable=!0;var i=this._callback;this._callback=null,i(!1)}},n._animationComplete=function(){this._loops++,0===this._currentAnimation.loops||this._loops<this._currentAnimation.loops?t.play(this._character,this._currentAnimation.event,this._animationComplete.bind(this),[],this._allowFrameDropping):this._currentAnimation.loops==this._loops&&this.startNext()},n.clear=function(){this._character&&t.stop(this._character),this._currentAnimation=null,this._interruptable=!0,this._callback=null,this._animationStack.length=0,this._loops=0},n.destroy=function(){this._destroyed||(this._destroyed=!0,this.clear(),this._character=null,this._animationStack=null)},namespace("cloudkid").CharacterController=i}();